{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AlpacaNewsCLient = void 0;\n\nconst websocket_1 = require(\"./websocket\");\n\nconst entityv2_1 = require(\"./entityv2\");\n\nconst websocket_2 = require(\"./websocket\");\n\nclass AlpacaNewsCLient extends websocket_2.AlpacaWebsocket {\n  constructor(options) {\n    const url = \"wss\" + options.url.substr(options.url.indexOf(\":\")) + \"/v1beta1/news\";\n    options.url = url;\n    options.subscriptions = {\n      news: []\n    };\n    super(options);\n  }\n\n  subscribeForNews(news) {\n    this.session.subscriptions.news.push(...news);\n    this.subscribe(news);\n  }\n\n  subscribe(news) {\n    const subMsg = {\n      action: \"subscribe\",\n      news\n    };\n    console.log(\"subscribing\", subMsg);\n    this.conn.send(this.msgpack.encode(subMsg));\n  }\n\n  subscribeAll() {\n    if (this.session.subscriptions.news.length > 0) {\n      this.subscribe(this.session.subscriptions.news);\n    }\n  }\n\n  unsubscribeFromNews(news) {\n    this.session.subscriptions.news = this.session.subscriptions.news.filter(n => !news.includes(n));\n    this.unsubscribe(news);\n  }\n\n  unsubscribe(news) {\n    const unsubMsg = {\n      action: \"unsubscribe\",\n      news\n    };\n    this.conn.send(this.msgpack.encode(unsubMsg));\n  }\n\n  updateSubscriptions(msg) {\n    this.log(`listening to streams:\n        news: ${msg.news}`);\n    this.session.subscriptions = {\n      news: msg.news\n    };\n  }\n\n  onNews(fn) {\n    this.on(websocket_1.EVENT.NEWS, n => fn(n));\n  }\n\n  dataHandler(data) {\n    data.forEach(element => {\n      if (\"T\" in element) {\n        switch (element.T) {\n          case \"n\":\n            this.emit(websocket_1.EVENT.NEWS, (0, entityv2_1.AlpacaNews)(element));\n            break;\n\n          default:\n            this.emit(websocket_1.EVENT.CLIENT_ERROR, websocket_1.ERROR.UNEXPECTED_MESSAGE);\n        }\n      } else {\n        this.emit(websocket_1.EVENT.CLIENT_ERROR, websocket_1.ERROR.UNEXPECTED_MESSAGE);\n      }\n    });\n  }\n\n}\n\nexports.AlpacaNewsCLient = AlpacaNewsCLient;","map":{"version":3,"names":["Object","defineProperty","exports","value","AlpacaNewsCLient","websocket_1","require","entityv2_1","websocket_2","AlpacaWebsocket","constructor","options","url","substr","indexOf","subscriptions","news","subscribeForNews","session","push","subscribe","subMsg","action","console","log","conn","send","msgpack","encode","subscribeAll","length","unsubscribeFromNews","filter","n","includes","unsubscribe","unsubMsg","updateSubscriptions","msg","onNews","fn","on","EVENT","NEWS","dataHandler","data","forEach","element","T","emit","AlpacaNews","CLIENT_ERROR","ERROR","UNEXPECTED_MESSAGE"],"sources":["/Users/matthewbrown/Desktop/code/Summer/Stock-Portfolio/stock-portfolio/node_modules/@alpacahq/alpaca-trade-api/dist/resources/datav2/news_websocket.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AlpacaNewsCLient = void 0;\nconst websocket_1 = require(\"./websocket\");\nconst entityv2_1 = require(\"./entityv2\");\nconst websocket_2 = require(\"./websocket\");\nclass AlpacaNewsCLient extends websocket_2.AlpacaWebsocket {\n    constructor(options) {\n        const url = \"wss\" + options.url.substr(options.url.indexOf(\":\")) + \"/v1beta1/news\";\n        options.url = url;\n        options.subscriptions = {\n            news: [],\n        };\n        super(options);\n    }\n    subscribeForNews(news) {\n        this.session.subscriptions.news.push(...news);\n        this.subscribe(news);\n    }\n    subscribe(news) {\n        const subMsg = {\n            action: \"subscribe\",\n            news,\n        };\n        console.log(\"subscribing\", subMsg);\n        this.conn.send(this.msgpack.encode(subMsg));\n    }\n    subscribeAll() {\n        if (this.session.subscriptions.news.length > 0) {\n            this.subscribe(this.session.subscriptions.news);\n        }\n    }\n    unsubscribeFromNews(news) {\n        this.session.subscriptions.news = this.session.subscriptions.news.filter((n) => !news.includes(n));\n        this.unsubscribe(news);\n    }\n    unsubscribe(news) {\n        const unsubMsg = {\n            action: \"unsubscribe\",\n            news,\n        };\n        this.conn.send(this.msgpack.encode(unsubMsg));\n    }\n    updateSubscriptions(msg) {\n        this.log(`listening to streams:\n        news: ${msg.news}`);\n        this.session.subscriptions = {\n            news: msg.news,\n        };\n    }\n    onNews(fn) {\n        this.on(websocket_1.EVENT.NEWS, (n) => fn(n));\n    }\n    dataHandler(data) {\n        data.forEach((element) => {\n            if (\"T\" in element) {\n                switch (element.T) {\n                    case \"n\":\n                        this.emit(websocket_1.EVENT.NEWS, (0, entityv2_1.AlpacaNews)(element));\n                        break;\n                    default:\n                        this.emit(websocket_1.EVENT.CLIENT_ERROR, websocket_1.ERROR.UNEXPECTED_MESSAGE);\n                }\n            }\n            else {\n                this.emit(websocket_1.EVENT.CLIENT_ERROR, websocket_1.ERROR.UNEXPECTED_MESSAGE);\n            }\n        });\n    }\n}\nexports.AlpacaNewsCLient = AlpacaNewsCLient;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}